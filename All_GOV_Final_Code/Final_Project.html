<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Final_Project_1st_Half</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Final_Project_files/libs/clipboard/clipboard.min.js"></script>
<script src="Final_Project_files/libs/quarto-html/quarto.js"></script>
<script src="Final_Project_files/libs/quarto-html/popper.min.js"></script>
<script src="Final_Project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Final_Project_files/libs/quarto-html/anchor.min.js"></script>
<link href="Final_Project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Final_Project_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Final_Project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Final_Project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Final_Project_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Final_Project_1st_Half</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/52078017/create-similarity-matrix</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Loading all the CA House and Senate data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Each csv file in Edge_Lists represents 1 network. The first two columns are the sender/receiver identified with their "EID" (the identifier provided by NIMP). The third column is used to identify what threshold the edge was</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>CA_2011_2012_Senate_edges <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Edgelist/CA-2011-2012-Senate.csv"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>CA_2011_2012_Senate <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Metadata/CA-2011-2012-Senate.csv"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>CA_2013_2014_Senate_edges <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Edgelist/CA-2013-2014-Senate.csv"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>CA_2013_2014_Senate <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Metadata/CA-2013-2014-Senate.csv"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>CA_2015_2016_Senate_edges <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Edgelist/CA-2015-2016-Senate.csv"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>CA_2015_2016_Senate <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Metadata/CA-2015-2016-Senate.csv"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>CA_2011_2012_House <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Metadata/CA-2011-2012-House.csv"</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>CA_2011_2012_House_edges <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Edgelist/CA-2011-2012-House.csv"</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>CA_2013_2014_House <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Metadata/CA-2013-2014-House.csv"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>CA_2013_2014_House_edges <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Edgelist/CA-2013-2014-House.csv"</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>CA_2015_2016_House <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Metadata/CA-2015-2016-House.csv"</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>CA_2015_2016_House_edges <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Edgelist/CA-2015-2016-House.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#function to clean the data for visualizations</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>clean_data <span class="ot">&lt;-</span> <span class="cf">function</span>(nodes, edges) {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  house_data_1 <span class="ot">&lt;-</span> nodes <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">"Total"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">node_1 =</span> EID) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>EID, <span class="sc">-</span>DemCol, <span class="sc">-</span>RepCol) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(edges, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"node_1"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Total_1 =</span> Total) <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name_1 =</span> ContributorName) <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">group_1 =</span> CatCodeGroup) <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">PerDem_1 =</span> PerDem)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  house_data_2 <span class="ot">&lt;-</span> nodes <span class="sc">%&gt;%</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">"Total"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">node_2 =</span> EID) <span class="sc">%&gt;%</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>EID, <span class="sc">-</span>DemCol, <span class="sc">-</span>RepCol) <span class="sc">%&gt;%</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(edges, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"node_2"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Total_2 =</span> Total) <span class="sc">%&gt;%</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name_2 =</span> ContributorName) <span class="sc">%&gt;%</span> </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">group_2 =</span> CatCodeGroup) <span class="sc">%&gt;%</span> </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">PerDem_2 =</span> PerDem) <span class="sc">%&gt;%</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(node_2, Total_2, name_2, group_2, PerDem_2)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  full_house <span class="ot">&lt;-</span> house_data_1 <span class="sc">%&gt;%</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(house_data_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"node_2"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Total =</span> Total_1 <span class="sc">+</span> Total_2) <span class="sc">%&gt;%</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Total))</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(full_house)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co">#function to create network of top 50 total donations between any donor tie based on yearly data</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>create_network <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(name_1, name_2, edge, Total, group_1, group_2, PerDem_1, PerDem_2)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  house_net <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(df, <span class="at">directed =</span> T) <span class="co">#%&gt;%</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Democrat</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">E</span>(house_net)<span class="sc">$</span>color[<span class="fu">which</span>(<span class="fu">E</span>(house_net)<span class="sc">$</span>PerDem_1 <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;</span> <span class="fu">E</span>(house_net)<span class="sc">$</span>PerDem_2 <span class="sc">&gt;=</span> <span class="dv">50</span>)] <span class="ot">&lt;-</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">5</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Republican</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">E</span>(house_net)<span class="sc">$</span>color[<span class="fu">which</span>(<span class="fu">E</span>(house_net)<span class="sc">$</span>PerDem_1 <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">&amp;</span> <span class="fu">E</span>(house_net)<span class="sc">$</span>PerDem_2 <span class="sc">&lt;</span> <span class="dv">50</span>)] <span class="ot">&lt;-</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, .<span class="dv">5</span>)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(house_net)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CA House (2011-2016) data and network </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>House_11_12 <span class="ot">&lt;-</span> <span class="fu">clean_data</span>(CA_2011_2012_House, CA_2011_2012_House_edges)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>House_11_12_network <span class="ot">&lt;-</span> <span class="fu">create_network</span>(House_11_12)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>House_13_14 <span class="ot">&lt;-</span> <span class="fu">clean_data</span>(CA_2013_2014_House, CA_2013_2014_House_edges)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>House_13_14_network <span class="ot">&lt;-</span> <span class="fu">create_network</span>(House_13_14)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>House_15_16 <span class="ot">&lt;-</span> <span class="fu">clean_data</span>(CA_2015_2016_House, CA_2015_2016_House_edges)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>House_15_16_network <span class="ot">&lt;-</span> <span class="fu">create_network</span>(House_15_16)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CA Senate (2011-2018) data and network </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>Senate_11_12 <span class="ot">&lt;-</span> <span class="fu">clean_data</span>(CA_2011_2012_Senate, CA_2011_2012_Senate_edges)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>Senate_11_12_network <span class="ot">&lt;-</span> <span class="fu">create_network</span>(Senate_11_12)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Senate_13_14 <span class="ot">&lt;-</span> <span class="fu">clean_data</span>(CA_2013_2014_Senate, CA_2013_2014_Senate_edges)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>Senate_13_14_network <span class="ot">&lt;-</span> <span class="fu">create_network</span>(Senate_13_14)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>Senate_15_16 <span class="ot">&lt;-</span> <span class="fu">clean_data</span>(CA_2015_2016_Senate, CA_2015_2016_Senate_edges)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>Senate_15_16_network <span class="ot">&lt;-</span> <span class="fu">create_network</span>(Senate_15_16)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Community Detection Algorithm for House 2011-2016</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#We want to see how the top echelon of political donors are grouped to detect any patterns</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Community Detection Algorithm to maximize modularity score increasing cohesiveness in the groups</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Network modularity to determine level of polarization per year especially among the more avid donors to see if they exhibit a tendency to only interact within their own party group</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Network Modularity = 0.19</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>House_11_12_opt <span class="ot">&lt;-</span> <span class="fu">cluster_optimal</span>(House_11_12_network)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#House_11_12_opt_plot &lt;- plot(House_11_12_opt, House_11_12_network, vertex.color = V(House_11_12_network)$color, vertex.size = 10) + title(main = "Network Modularity: ", sub = modularity(House_11_12_opt))  </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>House_11_12_opt_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(House_11_12_opt, House_11_12_network, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.color =</span> <span class="st">"black"</span>, <span class="at">edge.color =</span> <span class="fu">E</span>(House_11_12_network)<span class="sc">$</span>color, <span class="at">vertex.size =</span> <span class="dv">15</span>) <span class="sc">+</span> <span class="fu">title</span>(<span class="at">main =</span> <span class="st">"CA House 11-12 Network Modularity: "</span>, <span class="at">sub =</span> <span class="fu">modularity</span>(House_11_12_opt)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Final_Project_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Network Modularity = .23</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>House_13_14_opt <span class="ot">&lt;-</span> <span class="fu">cluster_optimal</span>(House_13_14_network)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#House_13_14_opt_plot &lt;- plot(House_13_14_opt, House_13_14_network, vertex.color = V(House_13_14_network)$color, vertex.size = 10) + title(main = "Network Modularity: ", sub = modularity(House_13_14_opt)) \</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>House_13_14_opt_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(House_13_14_opt, House_13_14_network, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.color =</span> <span class="st">"black"</span>, <span class="at">edge.color =</span> <span class="fu">E</span>(House_13_14_network)<span class="sc">$</span>color, <span class="at">vertex.size =</span> <span class="dv">15</span>) <span class="sc">+</span> <span class="fu">title</span>(<span class="at">main =</span> <span class="st">"CA House 13-14 Network Modularity: "</span>, <span class="at">sub =</span> <span class="fu">modularity</span>(House_13_14_opt))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Final_Project_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Network Modularity = .33</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>House_15_16_opt <span class="ot">&lt;-</span> <span class="fu">cluster_optimal</span>(House_15_16_network)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#House_15_16_opt_plot &lt;- plot(House_15_16_opt, House_15_16_network, vertex.color = V(House_15_16_network)$color, vertex.size = 10) + title(main = "Network Modularity: ", sub = modularity(House_15_16_opt))</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>House_15_16_opt_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(House_15_16_opt, House_15_16_network, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.color =</span> <span class="st">"black"</span>, <span class="at">edge.color =</span> <span class="fu">E</span>(House_15_16_network)<span class="sc">$</span>color, <span class="at">vertex.size =</span> <span class="dv">15</span>) <span class="sc">+</span> <span class="fu">title</span>(<span class="at">main =</span> <span class="st">"CA House 15-16 Network Modularity: "</span>, <span class="at">sub =</span> <span class="fu">modularity</span>(House_15_16_opt))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Final_Project_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Network Modularity increased every yearly cycle implying a higher level of polarization as time passed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Community Detection Algorithm for Senate 2011-2016</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#We want to see how the top echelon of political donors are grouped to detect any patterns</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Community Detection Algorithm to maximize modularity score increasing cohesiveness in the groups</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Network modularity to determine level of polarization per year especially among the more avid donors to see if they exhibit a tendency to only interact within their own party group</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Network Modularity = 0.2</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>Senate_11_12_opt <span class="ot">&lt;-</span> <span class="fu">cluster_optimal</span>(Senate_11_12_network)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Senate_11_12_opt_plot &lt;- plot(Senate_11_12_opt, Senate_11_12_network, vertex.color = V(Senate_11_12_network)$color, vertex.size = 10) + title(main = "Network Modularity: ", sub = modularity(Senate_11_12_opt))  </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>Senate_11_12_opt_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(Senate_11_12_opt, Senate_11_12_network, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.color =</span> <span class="st">"black"</span>, <span class="at">edge.color =</span> <span class="fu">E</span>(Senate_11_12_network)<span class="sc">$</span>color, <span class="at">vertex.size =</span> <span class="dv">15</span>) <span class="sc">+</span> <span class="fu">title</span>(<span class="at">main =</span> <span class="st">"CA Senate 11-12 Network Modularity: "</span>, <span class="at">sub =</span> <span class="fu">modularity</span>(Senate_11_12_opt))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Final_Project_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Network Modularity = 0.15</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Senate_13_14_opt <span class="ot">&lt;-</span> <span class="fu">cluster_optimal</span>(Senate_13_14_network)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Senate_13_14_opt_plot &lt;- plot(Senate_13_14_opt, Senate_13_14_network, vertex.color = V(Senate_13_14_network)$color, vertex.size = 10) + title(main = "Network Modularity: ", sub = modularity(Senate_13_14_opt))  </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>Senate_13_14_opt_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(Senate_13_14_opt, Senate_13_14_network, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.color =</span> <span class="st">"black"</span>, <span class="at">edge.color =</span> <span class="fu">E</span>(Senate_13_14_network)<span class="sc">$</span>color, <span class="at">vertex.size =</span> <span class="dv">15</span>) <span class="sc">+</span> <span class="fu">title</span>(<span class="at">main =</span> <span class="st">"CA Senate 13-14 Network Modularity: "</span>, <span class="at">sub =</span> <span class="fu">modularity</span>(Senate_13_14_opt))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Final_Project_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Network Modularity = 0.22</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>Senate_15_16_opt <span class="ot">&lt;-</span> <span class="fu">cluster_optimal</span>(Senate_15_16_network)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Senate_15_16_opt_plot &lt;- plot(Senate_15_16_opt, Senate_15_16_network, vertex.color = V(Senate_15_16_network)$color, vertex.size = 10) + title(main = "Network Modularity: ", sub = modularity(Senate_15_16_opt))  </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>Senate_15_16_opt_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(Senate_15_16_opt, Senate_15_16_network, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.color =</span> <span class="st">"black"</span>, <span class="at">edge.color =</span> <span class="fu">E</span>(Senate_15_16_network)<span class="sc">$</span>color, <span class="at">vertex.size =</span> <span class="dv">15</span>) <span class="sc">+</span> <span class="fu">title</span>(<span class="at">main =</span> <span class="st">"CA Senate 15-16 Network Modularity: "</span>, <span class="at">sub =</span> <span class="fu">modularity</span>(Senate_15_16_opt))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Final_Project_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The Network Modularity remained relatively stable with little change meaning there wasn't a significant increase in polarization</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#function to isolate the industries or groups within the top 25% prevalence separated by party</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>isolate_both_groups <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  dem_group <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(PerDem <span class="sc">&gt;=</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(EID, PerDem, CatCodeGroup) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">dem_donor =</span> EID, <span class="at">dem_group =</span> CatCodeGroup) <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(dem_group) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">freq =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">freq_cat =</span> <span class="fu">ntile</span>(freq, <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(freq_cat <span class="sc">==</span> <span class="dv">4</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  rep_group <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(PerRep <span class="sc">&gt;=</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(EID, PerRep, CatCodeGroup) <span class="sc">%&gt;%</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">rep_donor =</span> EID, <span class="at">rep_group =</span> CatCodeGroup) <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(rep_group) <span class="sc">%&gt;%</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">freq =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">freq_cat =</span> <span class="fu">ntile</span>(freq, <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(freq_cat <span class="sc">==</span> <span class="dv">4</span> )</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  both_groups <span class="ot">&lt;-</span> dem_group <span class="sc">%&gt;%</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>   <span class="fu">bind_rows</span>(rep_group) <span class="sc">%&gt;%</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(<span class="sc">-</span>freq_cat)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(both_groups)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CA House (2011-2016) data and network </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>House_11_12_groups <span class="ot">&lt;-</span> <span class="fu">isolate_both_groups</span>(CA_2011_2012_House)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>House_13_14_groups <span class="ot">&lt;-</span> <span class="fu">isolate_both_groups</span>(CA_2013_2014_House)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>House_15_16_groups <span class="ot">&lt;-</span> <span class="fu">isolate_both_groups</span>(CA_2015_2016_House)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>House_11_12_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  dem_group                         freq rep_group                       
  &lt;chr&gt;                            &lt;int&gt; &lt;chr&gt;                           
1 Finance, Insurance &amp; Real Estate   120 &lt;NA&gt;                            
2 Health                             107 &lt;NA&gt;                            
3 Labor                              217 &lt;NA&gt;                            
4 Uncoded                            353 &lt;NA&gt;                            
5 &lt;NA&gt;                                32 Agriculture                     
6 &lt;NA&gt;                                46 Finance, Insurance &amp; Real Estate
7 &lt;NA&gt;                                34 General Business                
8 &lt;NA&gt;                               153 Uncoded                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>House_13_14_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  dem_group                         freq rep_group                       
  &lt;chr&gt;                            &lt;int&gt; &lt;chr&gt;                           
1 Finance, Insurance &amp; Real Estate   118 &lt;NA&gt;                            
2 Health                             119 &lt;NA&gt;                            
3 Labor                              201 &lt;NA&gt;                            
4 Uncoded                            415 &lt;NA&gt;                            
5 &lt;NA&gt;                                18 Energy &amp; Natural Resources      
6 &lt;NA&gt;                                19 Finance, Insurance &amp; Real Estate
7 &lt;NA&gt;                               126 Uncoded                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>House_15_16_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  dem_group                         freq rep_group                       
  &lt;chr&gt;                            &lt;int&gt; &lt;chr&gt;                           
1 Finance, Insurance &amp; Real Estate    91 &lt;NA&gt;                            
2 Health                             102 &lt;NA&gt;                            
3 Labor                              154 &lt;NA&gt;                            
4 Uncoded                            352 &lt;NA&gt;                            
5 &lt;NA&gt;                                15 Agriculture                     
6 &lt;NA&gt;                                28 Finance, Insurance &amp; Real Estate
7 &lt;NA&gt;                                22 General Business                
8 &lt;NA&gt;                               118 Uncoded                         </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CA Senate (2011-2016) data and network </span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Senate_11_12_groups <span class="ot">&lt;-</span> <span class="fu">isolate_both_groups</span>(CA_2011_2012_Senate)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>Senate_13_14_groups <span class="ot">&lt;-</span> <span class="fu">isolate_both_groups</span>(CA_2013_2014_Senate)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>Senate_15_16_groups <span class="ot">&lt;-</span> <span class="fu">isolate_both_groups</span>(CA_2015_2016_Senate)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>Senate_11_12_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  dem_group                         freq rep_group                       
  &lt;chr&gt;                            &lt;int&gt; &lt;chr&gt;                           
1 Finance, Insurance &amp; Real Estate    58 &lt;NA&gt;                            
2 Health                              56 &lt;NA&gt;                            
3 Labor                              115 &lt;NA&gt;                            
4 Uncoded                             92 &lt;NA&gt;                            
5 &lt;NA&gt;                                65 Finance, Insurance &amp; Real Estate
6 &lt;NA&gt;                                40 General Business                
7 &lt;NA&gt;                                74 Uncoded                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Senate_13_14_groups </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  dem_group                         freq rep_group                       
  &lt;chr&gt;                            &lt;int&gt; &lt;chr&gt;                           
1 Finance, Insurance &amp; Real Estate    73 &lt;NA&gt;                            
2 Health                              92 &lt;NA&gt;                            
3 Labor                              114 &lt;NA&gt;                            
4 Uncoded                            128 &lt;NA&gt;                            
5 &lt;NA&gt;                                40 Agriculture                     
6 &lt;NA&gt;                                39 Finance, Insurance &amp; Real Estate
7 &lt;NA&gt;                                85 Uncoded                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Senate_15_16_groups </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  dem_group  freq rep_group                       
  &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;                           
1 Health       89 &lt;NA&gt;                            
2 Labor       125 &lt;NA&gt;                            
3 Uncoded     158 &lt;NA&gt;                            
4 &lt;NA&gt;         12 Finance, Insurance &amp; Real Estate
5 &lt;NA&gt;          9 General Business                
6 &lt;NA&gt;         28 Uncoded                         </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#functions to find the probabilities of the five groups we wanted to focus on in regards to how often either group backed the same candidate versus mainly having ties within the same group separated by both parties</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>dem_probability_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(nodes, edges) {</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  dem_nodes_2 <span class="ot">&lt;-</span> nodes <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(PerDem <span class="sc">&gt;=</span> <span class="dv">50</span>, (CatCodeGroup <span class="sc">==</span> <span class="st">"Health"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Labor"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Agriculture"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"General Business"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Finance, Insurance &amp; Real Estate"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dem_node =</span> EID) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dem_group =</span> CatCodeGroup) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(dem_node, dem_group)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  dem_nodes_1 <span class="ot">&lt;-</span> nodes <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(PerDem <span class="sc">&gt;=</span> <span class="dv">50</span>, (CatCodeGroup <span class="sc">==</span> <span class="st">"Health"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Labor"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Agriculture"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"General Business"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Finance, Insurance &amp; Real Estate"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dem_node =</span> EID) <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dem_group =</span> CatCodeGroup) <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(EID, dem_node, dem_group) <span class="sc">%&gt;%</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(edges, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"EID"</span> <span class="ot">=</span> <span class="st">"node_1"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(dem_nodes_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"node_2"</span> <span class="ot">=</span> <span class="st">"dem_node"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>EID, <span class="sc">-</span>edge) <span class="sc">%&gt;%</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dem_node_2 =</span> node_2) <span class="sc">%&gt;%</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dem_group_1 =</span> dem_group.x) <span class="sc">%&gt;%</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dem_group_2 =</span> dem_group.y) <span class="sc">%&gt;%</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>dem_group.x, <span class="sc">-</span>dem_group.y, <span class="sc">-</span>node_2)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  d_p_matrix <span class="ot">&lt;-</span> <span class="fu">dcast</span>(<span class="fu">as.data.table</span>(dem_nodes_1), dem_group_1 <span class="sc">~</span> dem_group_2)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.data.frame</span>(d_p_matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]))</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  d_proportion_matrix <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(d_p_matrix) <span class="sc">%&gt;%</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Agriculture =</span> Agriculture<span class="sc">/</span>total, <span class="st">`</span><span class="at">General Business</span><span class="st">`</span> <span class="ot">=</span> d_p_matrix<span class="sc">$</span><span class="st">`</span><span class="at">General Business</span><span class="st">`</span><span class="sc">/</span>total, <span class="at">Health =</span> Health<span class="sc">/</span>total, <span class="at">Labor =</span> Labor<span class="sc">/</span>total, <span class="st">`</span><span class="at">Finance, Insurance &amp; Real Estate</span><span class="st">`</span> <span class="ot">=</span> d_p_matrix<span class="sc">$</span><span class="st">`</span><span class="at">Finance, Insurance &amp; Real Estate</span><span class="st">`</span><span class="sc">/</span> total)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(d_proportion_matrix)</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>rep_probability_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(nodes, edges) {</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>  rep_nodes_2 <span class="ot">&lt;-</span> nodes <span class="sc">%&gt;%</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(PerRep <span class="sc">&gt;=</span> <span class="dv">50</span>, (CatCodeGroup <span class="sc">==</span> <span class="st">"Health"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Labor"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Agriculture"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"General Business"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Finance, Insurance &amp; Real Estate"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_node =</span> EID) <span class="sc">%&gt;%</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_group =</span> CatCodeGroup) <span class="sc">%&gt;%</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(rep_node, rep_group)</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>rep_nodes_1 <span class="ot">&lt;-</span> nodes <span class="sc">%&gt;%</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(PerRep <span class="sc">&gt;=</span> <span class="dv">50</span>, (CatCodeGroup <span class="sc">==</span> <span class="st">"Health"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Labor"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Agriculture"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"General Business"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Finance, Insurance &amp; Real Estate"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_node =</span> EID) <span class="sc">%&gt;%</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_group =</span> CatCodeGroup) <span class="sc">%&gt;%</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(EID, rep_node, rep_group) <span class="sc">%&gt;%</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(edges, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"EID"</span> <span class="ot">=</span> <span class="st">"node_1"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(rep_nodes_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"node_2"</span> <span class="ot">=</span> <span class="st">"rep_node"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>EID, <span class="sc">-</span>edge) <span class="sc">%&gt;%</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_node_2 =</span> node_2) <span class="sc">%&gt;%</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_group_1 =</span> rep_group.x) <span class="sc">%&gt;%</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_group_2 =</span> rep_group.y) <span class="sc">%&gt;%</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>rep_group.x, <span class="sc">-</span>rep_group.y, <span class="sc">-</span>node_2)</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>  r_p_matrix <span class="ot">&lt;-</span> <span class="fu">dcast</span>(<span class="fu">as.data.table</span>(rep_nodes_1), rep_group_1 <span class="sc">~</span> rep_group_2)</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.data.frame</span>(r_p_matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]))</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>  r_proportion_matrix <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(r_p_matrix) <span class="sc">%&gt;%</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Agriculture =</span> Agriculture<span class="sc">/</span>total, <span class="st">`</span><span class="at">General Business</span><span class="st">`</span> <span class="ot">=</span> r_p_matrix<span class="sc">$</span><span class="st">`</span><span class="at">General Business</span><span class="st">`</span><span class="sc">/</span>total, <span class="at">Health =</span> Health<span class="sc">/</span>total, <span class="at">Labor =</span> Labor<span class="sc">/</span>total, <span class="st">`</span><span class="at">Finance, Insurance &amp; Real Estate</span><span class="st">`</span> <span class="ot">=</span> r_p_matrix<span class="sc">$</span><span class="st">`</span><span class="at">Finance, Insurance &amp; Real Estate</span><span class="st">`</span><span class="sc">/</span> total)</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r_proportion_matrix)</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a><span class="co">#CA Senate 2015-16 has a different shape due to NO Agriculture donors prevalent who donated over 50% of their funds for Republican candidates</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>rep_nodes_2 <span class="ot">&lt;-</span> CA_2015_2016_Senate <span class="sc">%&gt;%</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(PerRep <span class="sc">&gt;=</span> <span class="dv">50</span>, (CatCodeGroup <span class="sc">==</span> <span class="st">"Health"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Labor"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Agriculture"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"General Business"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Finance, Insurance &amp; Real Estate"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_node =</span> EID) <span class="sc">%&gt;%</span></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_group =</span> CatCodeGroup) <span class="sc">%&gt;%</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(rep_node, rep_group)</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>rep_nodes_1 <span class="ot">&lt;-</span> CA_2015_2016_Senate <span class="sc">%&gt;%</span></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(PerRep <span class="sc">&gt;=</span> <span class="dv">50</span>, (CatCodeGroup <span class="sc">==</span> <span class="st">"Health"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Labor"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Agriculture"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"General Business"</span> <span class="sc">|</span> CatCodeGroup <span class="sc">==</span> <span class="st">"Finance, Insurance &amp; Real Estate"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_node =</span> EID) <span class="sc">%&gt;%</span></span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_group =</span> CatCodeGroup) <span class="sc">%&gt;%</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(EID, rep_node, rep_group) <span class="sc">%&gt;%</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(CA_2015_2016_Senate_edges, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"EID"</span> <span class="ot">=</span> <span class="st">"node_1"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(rep_nodes_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"node_2"</span> <span class="ot">=</span> <span class="st">"rep_node"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>EID, <span class="sc">-</span>edge) <span class="sc">%&gt;%</span></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_node_2 =</span> node_2) <span class="sc">%&gt;%</span></span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_group_1 =</span> rep_group.x) <span class="sc">%&gt;%</span></span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep_group_2 =</span> rep_group.y) <span class="sc">%&gt;%</span></span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>rep_group.x, <span class="sc">-</span>rep_group.y, <span class="sc">-</span>node_2)</span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>  r_p_matrix <span class="ot">&lt;-</span> <span class="fu">dcast</span>(<span class="fu">as.data.table</span>(rep_nodes_1), rep_group_1 <span class="sc">~</span> rep_group_2)</span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.data.frame</span>(r_p_matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]))</span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>  r_proportion_matrix <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(r_p_matrix) <span class="sc">%&gt;%</span></span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="st">`</span><span class="at">General Business</span><span class="st">`</span> <span class="ot">=</span> r_p_matrix<span class="sc">$</span><span class="st">`</span><span class="at">General Business</span><span class="st">`</span><span class="sc">/</span>total, <span class="at">Health =</span> Health<span class="sc">/</span>total, <span class="at">Labor =</span> Labor<span class="sc">/</span>total, <span class="st">`</span><span class="at">Finance, Insurance &amp; Real Estate</span><span class="st">`</span> <span class="ot">=</span> r_p_matrix<span class="sc">$</span><span class="st">`</span><span class="at">Finance, Insurance &amp; Real Estate</span><span class="st">`</span><span class="sc">/</span> total)</span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a><span class="co">#Since the order of the tables made it so that Health-Labor and Labor-Health had different values this function sums up all the repeat pairing to give the true ranking of which industry pairings were more frequent for either party</span></span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>all_ties_p <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {</span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>  titles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Finance-Agriculture"</span>, <span class="st">"Business-Agriculture"</span>, <span class="st">"Health-Agriculture"</span>, <span class="st">"Labor-Agriculture"</span>, <span class="st">"Finance-Business"</span>, <span class="st">"Finance-Health"</span>, <span class="st">"Finance-Labor"</span>, <span class="st">"Business-Health"</span>, <span class="st">"Business-Labor"</span>, <span class="st">"Health-Labor"</span>, <span class="st">"Agriculture-Agriculture"</span>, <span class="st">"Finance-Finance"</span>, <span class="st">"Business-Business"</span>, <span class="st">"Health-Health"</span>, <span class="st">"Labor-Labor"</span>)</span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sum</span>(p[<span class="dv">2</span>, <span class="dv">2</span>], p[<span class="dv">1</span>, <span class="dv">3</span>]), <span class="fu">sum</span>(p[<span class="dv">3</span>, <span class="dv">2</span>], p[<span class="dv">1</span>, <span class="dv">4</span>]), <span class="fu">sum</span>(p[<span class="dv">4</span>, <span class="dv">2</span>], p[<span class="dv">1</span>, <span class="dv">5</span>]), <span class="fu">sum</span>(p[<span class="dv">5</span>, <span class="dv">2</span>], p[<span class="dv">1</span>, <span class="dv">6</span>]), <span class="fu">sum</span>(p[<span class="dv">2</span>, <span class="dv">4</span>], p[<span class="dv">3</span>, <span class="dv">3</span>]), <span class="fu">sum</span>(p[<span class="dv">2</span>, <span class="dv">5</span>], p[<span class="dv">4</span>, <span class="dv">3</span>]), <span class="fu">sum</span>(p[<span class="dv">2</span>, <span class="dv">6</span>], p[<span class="dv">5</span>, <span class="dv">3</span>]), <span class="fu">sum</span>(p[<span class="dv">3</span>, <span class="dv">5</span>], p[<span class="dv">4</span>, <span class="dv">4</span>]), <span class="fu">sum</span>(p[<span class="dv">3</span>, <span class="dv">6</span>], p[<span class="dv">5</span>, <span class="dv">4</span>]), <span class="fu">sum</span>(p[<span class="dv">4</span>, <span class="dv">6</span>], p[<span class="dv">5</span>, <span class="dv">5</span>]), p[<span class="dv">1</span>, <span class="dv">2</span>], p[<span class="dv">2</span>, <span class="dv">3</span>], p[<span class="dv">3</span>, <span class="dv">4</span>], p[<span class="dv">4</span>, <span class="dv">5</span>], p[<span class="dv">5</span>, <span class="dv">6</span>])</span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(results, <span class="at">row.names =</span> titles)</span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>  total <span class="ot">&lt;-</span> total <span class="sc">%&gt;%</span></span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(results))</span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(total)</span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The remaining code chunks output the probability matrices for all House and Senate years (2011-16) separated by party</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">all_ties_p</span>(<span class="fu">dem_probability_matrix</span>(CA_2011_2012_House, CA_2011_2012_House_edges))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            results
Labor-Labor             0.128457843
Finance-Health          0.122701673
Health-Labor            0.105122577
Finance-Labor           0.101519795
Finance-Business        0.095494451
Business-Health         0.092015902
Business-Labor          0.077314892
Health-Health           0.067852410
Finance-Finance         0.065533378
Business-Business       0.037560046
Finance-Agriculture     0.028573795
Health-Agriculture      0.027931920
Business-Agriculture    0.022983270
Labor-Agriculture       0.022486334
Agriculture-Agriculture 0.004451714</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all_ties_p</span>(<span class="fu">rep_probability_matrix</span>(CA_2011_2012_House, CA_2011_2012_House_edges))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            results
Finance-Business        0.157242213
Finance-Agriculture     0.135470215
Business-Agriculture    0.124281826
Agriculture-Agriculture 0.105836105
Finance-Health          0.098881161
Business-Health         0.091926217
Finance-Finance         0.085576051
Business-Business       0.065618385
Health-Agriculture      0.061687330
Health-Health           0.028424554
Business-Labor          0.013607499
Finance-Labor           0.011793166
Labor-Agriculture       0.009978833
Health-Labor            0.007559722
Labor-Labor             0.002116722</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all_ties_p</span>(<span class="fu">dem_probability_matrix</span>(CA_2013_2014_House, CA_2013_2014_House_edges))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           results
Health-Labor            0.11672593
Finance-Health          0.10811654
Labor-Labor             0.10549629
Finance-Labor           0.10063011
Business-Health         0.09248861
Finance-Business        0.09178676
Business-Labor          0.09050783
Health-Health           0.06349429
Finance-Finance         0.05229584
Business-Business       0.03919458
Health-Agriculture      0.03554495
Finance-Agriculture     0.03552935
Business-Agriculture    0.03247239
Labor-Agriculture       0.02751263
Agriculture-Agriculture 0.00820388</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all_ties_p</span>(<span class="fu">rep_probability_matrix</span>(CA_2013_2014_House, CA_2013_2014_House_edges))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            results
Business-Agriculture    0.164887307
Finance-Business        0.143534994
Finance-Agriculture     0.106761566
Agriculture-Agriculture 0.088967972
Finance-Health          0.087781732
Business-Health         0.084223013
Finance-Finance         0.080664294
Health-Agriculture      0.071174377
Business-Business       0.067615658
Health-Health           0.030842230
Business-Labor          0.022538553
Labor-Agriculture       0.018979834
Health-Labor            0.015421115
Finance-Labor           0.010676157
Labor-Labor             0.005931198</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all_ties_p</span>(<span class="fu">dem_probability_matrix</span>(CA_2015_2016_House, CA_2015_2016_House_edges))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            results
Health-Labor            0.133880507
Finance-Health          0.109474955
Finance-Labor           0.104477972
Labor-Labor             0.101750151
Business-Health         0.091852746
Finance-Business        0.083114062
Business-Labor          0.082510561
Health-Health           0.075051298
Finance-Finance         0.051828606
Business-Business       0.036330718
Health-Agriculture      0.034351237
Finance-Agriculture     0.032130356
Business-Agriculture    0.029668075
Labor-Agriculture       0.027012674
Agriculture-Agriculture 0.006566083</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all_ties_p</span>(<span class="fu">rep_probability_matrix</span>(CA_2015_2016_House, CA_2015_2016_House_edges))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            results
Finance-Business        0.194070081
Business-Agriculture    0.143755615
Finance-Agriculture     0.118598383
Finance-Finance         0.117699910
Finance-Health          0.093441150
Business-Health         0.088948787
Business-Business       0.081761006
Agriculture-Agriculture 0.061994609
Health-Agriculture      0.054806828
Health-Health           0.021563342
Labor-Agriculture       0.009883199
Business-Labor          0.008086253
Health-Labor            0.003593890
Finance-Labor           0.001796945
Labor-Labor             0.000000000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all_ties_p</span>(<span class="fu">dem_probability_matrix</span>(CA_2011_2012_Senate, CA_2011_2012_Senate_edges))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            results
Labor-Labor             0.159932156
Health-Labor            0.138281952
Finance-Labor           0.137783099
Business-Labor          0.111393794
Finance-Health          0.087299212
Finance-Business        0.079068143
Business-Health         0.066447172
Finance-Finance         0.049835379
Health-Health           0.041554425
Labor-Agriculture       0.031677143
Business-Business       0.029332535
Finance-Agriculture     0.024593435
Business-Agriculture    0.019854335
Health-Agriculture      0.019804450
Agriculture-Agriculture 0.003142772</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all_ties_p</span>(<span class="fu">rep_probability_matrix</span>(CA_2011_2012_Senate, CA_2011_2012_Senate_edges))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             results
Finance-Business        0.1754471704
Finance-Health          0.1513048578
Finance-Finance         0.1334180432
Finance-Agriculture     0.1207115629
Business-Health         0.0969602189
Business-Agriculture    0.0778027563
Health-Agriculture      0.0667578927
Business-Business       0.0561039977
Health-Health           0.0473072036
Agriculture-Agriculture 0.0290294204
Finance-Labor           0.0168116509
Business-Labor          0.0110448636
Health-Labor            0.0101651842
Labor-Agriculture       0.0067442088
Labor-Labor             0.0003909686</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all_ties_p</span>(<span class="fu">dem_probability_matrix</span>(CA_2013_2014_Senate, CA_2013_2014_Senate_edges))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            results
Health-Labor            0.145265516
Finance-Health          0.137827048
Finance-Labor           0.113357650
Labor-Labor             0.104569344
Health-Health           0.097475516
Business-Health         0.094632241
Business-Labor          0.092909044
Finance-Business        0.073264597
Finance-Finance         0.052815991
Business-Business       0.025532037
Health-Agriculture      0.019070048
Labor-Agriculture       0.017059651
Finance-Agriculture     0.014302536
Business-Agriculture    0.010884862
Agriculture-Agriculture 0.001033918</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all_ties_p</span>(<span class="fu">rep_probability_matrix</span>(CA_2013_2014_Senate, CA_2013_2014_Senate_edges))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             results
Business-Agriculture    0.1846130079
Finance-Agriculture     0.1809052989
Finance-Business        0.1569596787
Agriculture-Agriculture 0.1154024409
Finance-Finance         0.0756990576
Business-Business       0.0750811061
Health-Agriculture      0.0665842731
Business-Health         0.0554611463
Finance-Health          0.0548431948
Health-Health           0.0095782481
Finance-Labor           0.0078788815
Business-Labor          0.0075699058
Labor-Agriculture       0.0067974664
Health-Labor            0.0024718060
Labor-Labor             0.0001544879</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all_ties_p</span>(<span class="fu">dem_probability_matrix</span>(CA_2015_2016_Senate, CA_2015_2016_Senate_edges))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            results
Health-Labor            0.117718792
Finance-Health          0.109609365
Finance-Labor           0.101723507
Business-Health         0.095687167
Business-Labor          0.088146823
Finance-Business        0.087211902
Labor-Labor             0.077618796
Health-Health           0.062639730
Finance-Finance         0.050140238
Health-Agriculture      0.045242063
Finance-Agriculture     0.042112109
Labor-Agriculture       0.038514695
Business-Business       0.037356205
Business-Agriculture    0.037091988
Agriculture-Agriculture 0.009186618</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2015-2016 Senate has no occurrence of any Agriculture group</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>r_titles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Finance-Finance"</span>, <span class="st">"Business-Business"</span>, <span class="st">"Health-Health"</span>, <span class="st">"Labor-Labor"</span>, <span class="st">"Finance-Business"</span>, <span class="st">"Finance-Health"</span>, <span class="st">"Finance-Labor"</span>, <span class="st">"Business-Health"</span>, <span class="st">"Business-Labor"</span>, <span class="st">"Health-Labor"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>r_results <span class="ot">&lt;-</span> <span class="fu">c</span>(r_proportion_matrix[<span class="dv">1</span>, <span class="dv">2</span>], r_proportion_matrix[<span class="dv">2</span>, <span class="dv">3</span>], r_proportion_matrix[<span class="dv">3</span>, <span class="dv">4</span>], r_proportion_matrix[<span class="dv">4</span>, <span class="dv">5</span>], <span class="fu">sum</span>(r_proportion_matrix[<span class="dv">1</span>, <span class="dv">3</span>], r_proportion_matrix[<span class="dv">2</span>, <span class="dv">3</span>]), <span class="fu">sum</span>(r_proportion_matrix[<span class="dv">1</span>, <span class="dv">4</span>], r_proportion_matrix[<span class="dv">3</span>, <span class="dv">2</span>]), <span class="fu">sum</span>(r_proportion_matrix[<span class="dv">1</span>, <span class="dv">5</span>], r_proportion_matrix[<span class="dv">4</span>, <span class="dv">2</span>]), <span class="fu">sum</span>(r_proportion_matrix[<span class="dv">2</span>, <span class="dv">4</span>], r_proportion_matrix[<span class="dv">3</span>, <span class="dv">3</span>]), <span class="fu">sum</span>(r_proportion_matrix[<span class="dv">2</span>, <span class="dv">5</span>], r_proportion_matrix[<span class="dv">4</span>, <span class="dv">3</span>]), <span class="fu">sum</span>(r_proportion_matrix[<span class="dv">3</span>, <span class="dv">5</span>], r_proportion_matrix[<span class="dv">4</span>, <span class="dv">4</span>]))</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>r_total <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(r_results, <span class="at">row.names =</span> r_titles)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>r_total <span class="ot">&lt;-</span> r_total <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">arrange</span>(<span class="fu">desc</span>(r_results))</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>r_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    r_results
Finance-Business  0.333333333
Finance-Finance   0.212560386
Business-Business 0.140096618
Finance-Health    0.091787440
Business-Health   0.091787440
Business-Labor    0.028985507
Finance-Labor     0.019323671
Health-Health     0.009661836
Labor-Labor       0.000000000
Health-Labor      0.000000000</code></pre>
</div>
</div>
<p>References Consulted</p>
<p>Reuning, Kevin. <em>Election Donation Networks</em>. Harvard Dataverse, 4 June 2020, https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi%3A10.7910%2FDVN%2FYMDFPW.</p>
<p>“Create Similarity Matrix.” Stack Overflow, 29 July 2018, https://stackoverflow.com/questions/52078017/create-similarity-matrix.</p>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>